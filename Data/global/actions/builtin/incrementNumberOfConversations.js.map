//CHECKSUM:71b41b1dd0919cee63921a77d0b379b48d83cda34ad295ed89ffddb09875f749
{"version":3,"sources":["../actions/incrementNumberOfConversations.js"],"names":["incrementNumberOfConversations","output","userId","event","target","botId","key","bp","kvs","getUserStorageKey","value","getStorageWithExpiry","undefined","setStorageWithExpiry","temp","args"],"mappings":";;AAAA;;;;;;;AAOA,MAAMA,8BAA8B,GAAG,MAAMC,MAAN,IAAgB;AACrD,QAAMC,MAAM,GAAGC,KAAK,CAACC,MAArB;AACA,QAAMC,KAAK,GAAGF,KAAK,CAACE,KAApB;AACA,QAAMC,GAAG,GAAGC,EAAE,CAACC,GAAH,CAAOC,iBAAP,CAAyBP,MAAzB,EAAiC,uBAAjC,CAAZ;AACA,MAAIQ,KAAK,GAAG,MAAMH,EAAE,CAACC,GAAH,CAAOG,oBAAP,CAA4BN,KAA5B,EAAmCC,GAAnC,CAAlB,CAJqD,CAKrD;;AACA,MAAII,KAAK,KAAKE,SAAd,EAAyB;AACvBF,IAAAA,KAAK,GAAG,CAAR;AACD,GAFD,MAEO;AACLA,IAAAA,KAAK;AACN;;AAED,QAAMH,EAAE,CAACC,GAAH,CAAOK,oBAAP,CAA4BR,KAA5B,EAAmCC,GAAnC,EAAwCI,KAAxC,CAAN;AACAI,EAAAA,IAAI,CAACb,MAAD,CAAJ,GAAeS,KAAf;AACD,CAdD;;AAgBA,OAAOV,8BAA8B,CAACe,IAAI,CAACd,MAAN,CAArC","sourceRoot":"/var/lib/jenkins/workspace/build-linux/modules/builtin/src/backend","sourcesContent":["/**\n * Increment the number of conversations\n * @title Increment number of conversations\n * @category Storage\n * @author Botpress, Inc.\n * @param {string} output - The state variable to output the count to\n */\nconst incrementNumberOfConversations = async output => {\n  const userId = event.target\n  const botId = event.botId\n  const key = bp.kvs.getUserStorageKey(userId, 'numberOfConversations')\n  let value = await bp.kvs.getStorageWithExpiry(botId, key)\n  // Value could be 0\n  if (value === undefined) {\n    value = 0\n  } else {\n    value++\n  }\n\n  await bp.kvs.setStorageWithExpiry(botId, key, value)\n  temp[output] = value\n}\n\nreturn incrementNumberOfConversations(args.output)\n"]}