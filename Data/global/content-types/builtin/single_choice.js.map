//CHECKSUM:765457f0af78a99b6f732c748952943405c11f838550908a780302c1b7029b0f
{"version":3,"sources":["../content-types/single_choice.js"],"names":["base","require","render","data","events","typing","push","type","value","text","quick_replies","choices","map","c","title","payload","toUpperCase","renderMessenger","content_type","renderElement","channel","module","exports","id","group","jsonSchema","description","required","properties","minItems","maxItems","items","typingIndicators","uiSchema","computePreviewText","formData","length","hidden"],"mappings":"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","sourceRoot":"/var/lib/jenkins/workspace/build-linux/modules/builtin/src/backend","sourcesContent":["const base = require('./_base')\n\nfunction render(data) {\n  const events = []\n\n  if (data.typing) {\n    events.push({\n      type: 'typing',\n      value: data.typing\n    })\n  }\n\n  return [\n    ...events,\n    {\n      text: data.text,\n      quick_replies: data.choices.map(c => ({\n        title: c.title,\n        payload: c.value.toUpperCase()\n      })),\n      typing: data.typing\n    }\n  ]\n}\n\nfunction renderMessenger(data) {\n  const events = []\n\n  if (data.typing) {\n    events.push({\n      type: 'typing',\n      value: data.typing\n    })\n  }\n  \n  return [\n    ...events,\n    {\n      text: data.text,\n      quick_replies: data.choices.map(c => ({\n        content_type: 'text',\n        title: c.title,\n        payload: c.value.toUpperCase()\n      }))\n    }\n  ]\n}\n\nfunction renderElement(data, channel) {\n  if (channel === 'web' || channel === 'api' || channel === 'telegram') {\n    return render(data)\n  } else if (channel === 'messenger') {\n    return renderMessenger(data)\n  }\n\n  return [] // TODO Handle channel not supported\n}\n\nmodule.exports = {\n  id: 'builtin_single-choice',\n  group: 'Built-in Messages',\n  title: 'Single Choice',\n\n  jsonSchema: {\n    description: 'Suggest choices to the user with the intention of picking only one (with an optional message)',\n    type: 'object',\n    required: ['choices'],\n    properties: {\n      text: {\n        type: 'string',\n        title: 'Message'\n      },\n      choices: {\n        type: 'array',\n        title: 'Choices',\n        minItems: 1,\n        maxItems: 10,\n        items: {\n          type: 'object',\n          required: ['title', 'value'],\n          properties: {\n            title: {\n              description: 'The title of the choice (this is what gets shown to the user)',\n              type: 'string',\n              title: 'Message'\n            },\n            value: {\n              description:\n                'The value that your bot gets when the user picks this choice (usually hidden from the user)',\n              type: 'string',\n              title: 'Value'\n            }\n          }\n        }\n      },\n      ...base.typingIndicators\n    }\n  },\n\n  uiSchema: {\n    text: {\n      'ui:field': 'i18n_field'\n    },\n    choices: {\n      'ui:field': 'i18n_array'\n    }\n  },\n  computePreviewText: formData =>\n    formData.choices && formData.text && `Choices (${formData.choices.length}) ${formData.text}`,\n  renderElement: renderElement,\n  hidden: true\n}\n"]}